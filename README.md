# 图文草稿批量生成器

一个基于 Vue 3 的单页面应用（SPA），用于运营团队快速批量生成电商图文草稿。

# 📄 声明

本项目由阿里云 ESA 提供加速、计算和保护![alt text](image.png)

---

## 功能特性

### 1. 素材输入模块
- **直接上传**：支持拖拽上传商品图片（JPG/PNG）和 Excel 文件
- **在线录入**：提供完整的商品信息表单（名称、类目、品牌、材质、尺寸、颜色、适用人群）
- **批量导入**：支持 Excel 模板下载和批量导入
- **参考物上传**：支持上传历史爆款截图或粘贴参考链接
- **素材库保存**：可选保存本次素材至本地素材库 (TODO)

### 2. 模板库模块
- **收藏模板**：将生成的草稿收藏为可复用的模板
- **模板管理**：查看、搜索、编辑和删除模板
- **模板预览**：显示模板封面图、标题模板、卖点文案模板
- **模板应用**：生成草稿时选择已有模板，批量应用模板样式

### 3. AI 集成模块
- **DeepSeek AI**：集成 DeepSeek 大模型生成高质量标题和卖点文案
- **灵活切换**：支持在规则生成和 AI 生成之间自由切换
- **智能回退**：AI 生成失败时自动使用规则生成，确保业务连续性
- **API 配置**：支持配置 DeepSeek API Key

### 4. 草稿生成与展示模块
- **一键生成**：基于商品信息自动生成图文草稿
- **Canvas 图片合成**：在商品图片底部添加卖点标签图层
- **智能文案生成**：支持规则生成和 AI 生成两种模式
- **卡片网格展示**：以卡片形式展示每个商品的生成结果
- **实时编辑**：支持直接编辑标题和卖点文案

### 5. 操作与导出功能
- **批量下载**：支持打包下载所有选中草稿图片（ZIP 格式）
- **批量复制**：支持批量复制文案到剪贴板
- **批量删除**：支持批量删除不需要的草稿
- **单草稿操作**：支持单个草稿的下载、复制、编辑、收藏和删除
- **微调功能**：提供侧边栏编辑界面，支持精细调整
- **状态保存**：所有生成结果和编辑状态自动保存到本地

## 技术栈

- **前端框架**：Vue 3 (组合式 API) + TypeScript
- **UI 组件库**：Element Plus
- **状态管理**：Pinia
- **路由管理**：Vue Router
- **图片处理**：Canvas API
- **Excel 处理**：xlsx
- **文件压缩**：JSZip
- **本地存储**：localStorage + IndexedDB
- **AI 集成**：DeepSeek API
- **构建工具**：Vite

## 项目结构

```
draft-flow/
├── src/
│   ├── components/              # Vue 组件
│   │   ├── MaterialInput.vue        # 素材输入组件
│   │   ├── DraftDisplay.vue         # 草稿展示组件
│   │   ├── OperationPanel.vue       # 操作面板组件
│   │   ├── TemplateLibrary.vue      # 模板库组件
│   │   └── AiSettingsDialog.vue     # AI 设置对话框
│   ├── views/                   # 页面组件
│   │   ├── HomePage.vue             # 首页
│   │   └── TemplatesPage.vue        # 模板库页面
│   ├── stores/                  # Pinia 状态管理
│   │   └── draft.ts                  # 草稿状态管理
│   ├── types/                   # TypeScript 类型定义
│   │   └── index.ts                  # 类型定义
│   ├── utils/                   # 工具函数
│   │   ├── file.ts                  # 文件操作工具
│   │   ├── generator.ts             # 草稿生成逻辑
│   │   ├── excel.ts                 # Excel 处理工具
│   │   ├── template.ts              # 模板处理工具
│   │   ├── deepseek.ts              # DeepSeek AI 集成
│   │   └── storage.ts               # IndexedDB 存储
│   ├── constants/               # 常量定义
│   │   └── index.ts                  # 类目和模板常量
│   ├── router/                  # 路由配置
│   │   └── index.ts                  # Vue Router 配置
│   ├── App.vue                  # 根组件
│   └── main.ts                  # 入口文件
├── index.html                   # HTML 模板
├── package.json                 # 项目配置
├── tsconfig.json                # TypeScript 配置
├── vite.config.ts               # Vite 配置
└── README.md                    # 项目说明
```

## 快速开始

### 1. 安装依赖

```bash
npm install
```

### 2. 启动开发服务器

```bash
npm run dev
```

项目将在 `http://localhost:3000` 启动，浏览器会自动打开。

### 3. 构建生产版本

```bash
npm run build
```

构建产物将输出到 `dist/` 目录。

### 4. 预览生产构建

```bash
npm run preview
```

## 使用指南

### 添加商品

#### 方式一：直接上传
1. 点击"直接上传"标签
2. 拖拽商品图片到上传区域，或点击上传
3. 点击图片填写商品信息
4. 可选：上传 Excel 文件批量导入商品

#### 方式二：在线录入
1. 点击"在线录入"标签
2. 填写商品信息（名称为必填项）
3. 上传商品图片
4. 点击"添加商品"按钮

#### 方式三：批量导入
1. 点击"下载 Excel 导入模板"获取模板文件
2. 填写商品信息后上传 Excel 文件

### 添加参考物（可选）
1. 在"参考物"区域上传历史爆款截图
2. 或在输入框中粘贴参考链接 URL
3. 点击"添加"按钮

### 生成草稿
1. 在右侧操作面板中选择生成模式：
   - **默认逻辑**：使用规则生成标题和卖点
   - **模板生成**：选择已有模板批量应用样式
2. 可选：点击"AI 设置"配置 DeepSeek API Key，启用 AI 生成
3. 点击"一键生成草稿"按钮
4. 等待生成完成（进度条显示生成进度）
5. 生成的草稿将显示在中间区域

### 收藏为模板
1. 点击草稿卡片上的"收藏"按钮
2. 填写模板名称
3. 选择要收藏的元素（主图、标题、卖点）
4. 添加标签
5. 点击确定保存

### 管理模板
1. 点击右上角"模板库"按钮进入模板管理页面
2. 可以查看、搜索、编辑和删除模板
3. 点击模板卡片可预览详情
4. 点击"使用"按钮可快速应用模板生成草稿

### 编辑草稿
1. 点击草稿卡片上的"微调"按钮
2. 在侧边栏中编辑标题和卖点文案
3. 点击"保存修改"按钮

### 导出草稿
1. 勾选需要导出的草稿卡片
2. 点击"批量下载图片"或"批量复制文案"按钮
3. 或单独点击每个卡片的"下载本图"或"复制文案"按钮

### 删除草稿
1. 点击草稿卡片上的"删除"按钮删除单个草稿
2. 或勾选多个草稿后点击"批量删除"按钮

## Excel 导入模板

点击"下载 Excel 导入模板"按钮可获取模板文件。模板包含以下字段：

| 字段 | 说明 | 必填 |
|------|------|------|
| 商品名称 | 商品名称 | 是 |
| 类目 | 商品类目（clothing/shoes/bags 等） | 否 |
| 品牌 | 商品品牌 | 否 |
| 材质 | 商品材质 | 否 |
| 尺寸 | 商品尺寸 | 否 |
| 颜色 | 商品颜色 | 否 |
| 适用人群 | 适用人群（多个用逗号分隔） | 否 |
| 图片 URL | 商品图片 URL | 否 |

## 核心功能说明

### 图片合成逻辑
使用 Canvas API 在商品图片底部添加半透明背景条，并根据类目自动填入 1-2 个基础卖点文案。支持自定义材质、颜色等参数替换。

### 文案生成逻辑

#### 规则生成
- **标题**：`${品牌} ${名称} ${适用人群} ${类目}`
- **卖点文案**：根据类目模板生成，包含材质、尺寸、适用人群等信息

#### AI 生成
集成 DeepSeek 大模型，根据商品信息生成更吸引人的标题和卖点文案。Prompt 示例：
- 标题：生成简洁有力的电商标题，20 字以内
- 卖点：生成 3 条卖点文案，每条 15-30 字，突出商品特点和优势

### 模板引擎
- **变量替换**：支持 `{{name}}`、`{{brand}}`、`{{category}}` 等变量
- **元素类型**：支持主图、标题、卖点三种元素类型
- **封面图**：收藏模板时自动保存封面图，便于识别和预览

### 状态管理
使用 Pinia 进行全局状态管理，支持：
- 商品列表管理
- 草稿结果管理
- 模板库管理
- 生成进度跟踪
- 选择状态管理
- AI 配置管理

### 本地存储
使用 localStorage 实现：
- 模板数据持久化
- AI 配置持久化
- 商品信息持久化
- 草稿结果持久化

## AI 集成说明

### DeepSeek API 配置
1. 点击操作面板中的"AI 设置"按钮
2. 输入 DeepSeek API Key（[获取地址](https://platform.deepseek.com/api_keys)）
3. 选择"AI 生成"模式
4. 点击保存

### 支持的变量
生成标题和卖点时，AI 会参考以下商品信息：
- 商品名称、品牌、类目
- 材质、尺寸、颜色
- 适用人群

### 费用说明
DeepSeek API 定价约为 $0.55-1.10/M tokens，成本较低。建议设置 API 调用限额以控制成本。

## 模板变量说明

收藏模板时，系统会自动将具体值替换为变量：

| 变量 | 说明 | 示例 |
|------|------|------|
| `{{name}}` | 商品名称 | "时尚外套" |
| `{{brand}}` | 品牌 | "优衣库" |
| `{{category}}` | 类目 | "clothing" |
| `{{audienceText}}` | 适用人群文本 | "men/women" |
| `{{material}}` | 材质 | "棉" |
| `{{size}}` | 尺寸 | "M" |
| `{{color}}` | 颜色 | "红色" |
| `{{targetAudience}}` | 适用人群 | "men" |

## 开发命令

```bash
# 启动开发服务器
npm run dev

# 类型检查
npm run typecheck

# 构建生产版本
npm run build

# 预览生产构建
npm run preview
```

## 浏览器兼容性

- Chrome >= 90
- Firefox >= 88
- Safari >= 14
- Edge >= 90

## 注意事项

1. **图片格式**：仅支持 JPG 和 PNG 格式
2. **图片大小**：建议单张图片不超过 5MB
3. **Excel 格式**：仅支持 .xlsx 和 .xls 格式
4. **本地存储**：localStorage 有大小限制，建议定期清理
5. **跨域问题**：如果使用外部图片 URL，需确保服务器支持 CORS
6. **AI 功能**：需要配置有效的 DeepSeek API Key 才能使用

## 待实现功能

- [ ] 本地素材库功能：保存和管理常用商品素材
- [ ] 更多 AI 提供商支持：通义千问、ChatGPT 等
- [ ] 主图 AI 生成：根据商品描述自动生成主图
- [ ] 图片智能优化：自动抠图、背景替换等

## 许可证

MIT License
